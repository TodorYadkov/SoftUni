<!-- Spinner -->
<app-loading [isLoading]="isLoading"></app-loading>

<!-- Display error  -->
<app-alert-message [errorMsgFromServer]="errorMsgFromServer" [autoHide]="true"></app-alert-message>

<div *ngIf="!isLoading" class="row mt-5 mb-4">
    <div class="col-md-3">
        <!-- User details -->
        <div *ngIf="userDetails">
            <div class="card">
                <div class="card card-profile p-4">
                    <div class=" image d-flex flex-column justify-content-center align-items-center">
                        <button class="btn btn-secondary"> <img src="/assets/profile-page.png" height="100"
                                width="100" /></button>
                        <span class="name mt-3 text-decoration-underline">{{userDetails.name}}</span>
                        <div class="d-flex flex-column justify-content-center">
                            <span class="idd"><i class="bi bi-envelope"></i> {{userDetails.email}}</span>
                            <span class="idd"><i class="bi bi-phone"></i> {{userDetails.phone}}</span>
                            <span class="idd"><i class="bi bi-house"></i> {{userDetails.address}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-9">
        <!-- Hide if the owner not have any restaurant -->
        <div class="card border-primary mb-4" *ngIf="userOrders.length > 0; else noOrders">
            <div class="card-body">
                <h3 class="card-title text-white fst-roboto"><i class="bi bi-list"></i> Моите сметки</h3>
                <div class="fst-roboto">

                    <table class="table rounded table-striped table-hover table-responsive">
                        <thead>
                            <tr>
                                <th scope="col">Детайли</th>
                                <th scope="col">Име</th>
                                <th scope="col">Store Name</th>
                                <th scope="col">Phone</th>
                                <th scope="col">Address</th>
                                <th scope="col">Delivery Address</th>
                                <th scope="col">Creation Time</th>
                                <th scope="col">Actions</th>
                            </tr>
                        </thead>
                        <tbody>

                            <ng-container *ngFor="let order of userOrders">
                                <tr>
                                    <td><img src="{{ order.restaurantId.image }}" alt="Store Image" width="50" /></td>
                                    <td>{{ order.restaurantId.name }}</td>
                                    <td>{{ order.restaurantId.address }}</td>
                                    <td>{{ order.restaurantId.phone }}</td>
                                    <td (click)="toggleRow()"><i class="bi bi-eye"></i></td>
                                    <td>{{ order.addressDelivery }}</td>
                                    <td>Predstoi da go napravq</td>
                                    <td>
                                        <button class="btn btn-primary btn-sm">Edit</button>
                                        <button class="btn btn-danger btn-sm">Delete</button>
                                    </td>
                                </tr>
                                <!-- Additional hide information from each order -->
                                <ng-container *ngIf="!isHiddenRow">
                                    <tr *ngFor="let product of hiddenRowDetails">
                                        <td><img src="{{product.image}}" alt="Store Image" width="50" /></td>
                                        <td>{{product.name}}</td>
                                        <td>{{product.weight}}</td>
                                        <td>{{product.price}}</td>
                                        <td>{{product.quantity}}</td>
                                        <td>{{product.totalCost}}</td>
                                    </tr>
                                </ng-container>

                            </ng-container>

                        </tbody>
                    </table>

                </div>
            </div>
        </div>

        <ng-template #noOrders>
            <div class="row">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="text-center fst-marck text-primary-emphasis my-5 py-4">
                            <h2 class="mt-4"><strong>Все още не сте пробвали да поръчате онлайн</strong></h2>
                            <h2>Направете го <a routerLink="/" class="alert-link">сега</a> и прекарайте повече време с
                                любимите си хора <i class="bi bi-emoji-smile"></i></h2>
                        </div>
                    </div>
                </div>
            </div>
        </ng-template>

    </div>
</div>